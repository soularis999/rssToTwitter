version: 0.1


phases:
  install:
    commands:
      - echo "Install phase"
      - sudo apt-get update -y
      - sudo apt-get install -y zip unzip
      - sudo pip install virtualenv
  pre_build:
    commands:
      - echo "pre build phase"
      - virtualenv -p python3.5 rsstotwitter
      - . rsstotwitter/bin/activate
      - pip install --upgrade -r config/requirements.txt
  build:
    commands:
      - echo "build phase"
      - cd rsstotwitter/lib/python3.5/site-packages/
      - ls -la
      - zip -r9 /tmp/rsstotwitter.zip *
      - cd ../../../../src/
      - ls -la
      - zip -rg /tmp/rsstotwitter.zip *
      - cd ../config
      - zip -g /tmp/rsstotwitter.zip twPostsConfig
  post_build:
    commands:
      - echo "post build phase"
      - cp rsstotwitter.zip /tmp/
artifacts:
  files:
    - target/rsstotwitter.zip
  discard-paths: yes